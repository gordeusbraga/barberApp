<app-header></app-header>


<div class="w-[90%] mx-auto font-sans border-b-2 border-purple-600 pb-4 mb-6">
    <section class="relative flex items-center p-6">
        <a routerLink="/home" class="h-6 w-6 cursor-pointer absolute left-6 top-1/2 -translate-y-1/2">
            <img src="../../../assets/arrow.png" alt="voltar" />
        </a>
        <h2 class="w-full text-center text-3xl font-semibold pt-3">
            Gerenciar Agendamentos
        </h2>
    </section>
</div>


<section class="w-[90%] mx-auto font-sans mb-10">
    <div *ngIf="isLoading" class="text-center p-10">
        <p class="text-lg text-gray-500">Carregando agendamentos...</p>
    </div>

    <div *ngIf="!isLoading && agendamentos.length === 0" class="text-center p-10">
        <p class="text-lg text-gray-500">Nenhum agendamento encontrado.</p>
    </div>


    <div *ngIf="!isLoading && agendamentos.length > 0" class="space-y-4">
        <div *ngFor="let agendamento of agendamentos"
            class="p-4 bg-white rounded-xl shadow-md border border-gray-200 flex flex-col sm:flex-row justify-between items-start">


            <div class="flex-1">
                <p class="font-semibold text-lg text-gray-800">{{ agendamento.services.name }}</p>
                <p class="text-sm text-gray-500">Cliente: <span class="font-medium text-gray-700">{{
                        agendamento.profiles.name }}</span></p>
                <p class="text-sm text-gray-500">Horário:
                    <span class="font-medium text-purple-600">
                        {{ agendamento.appointment_time | date:'dd/MM/yyyy' }} às {{ agendamento.appointment_time |
                        date:'HH:mm' }}
                    </span>
                </p>
            </div>


            <div class="w-full sm:w-auto mt-4 sm:mt-0 sm:text-right">

                <div *ngIf="agendamento.status === 'agendado' && !agendamento.isLoading" class="flex sm:flex-col gap-2">
                    <button (click)="finalizar(agendamento)"
                        class="flex-1 rounded-lg bg-green-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-green-700">
                        Finalizar
                    </button>
                    <button (click)="cancelar(agendamento)"
                        class="flex-1 rounded-lg bg-red-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-red-700">
                        Cancelar
                    </button>
                </div>


                <div *ngIf="agendamento.isLoading" class="text-center p-2">
                    <p class="text-sm text-gray-500">Atualizando...</p>
                </div>


                <div *ngIf="agendamento.status === 'concluido' && !agendamento.isLoading">
                    <span
                        class="inline-flex items-center rounded-md bg-green-100 px-3 py-1 text-sm font-medium text-green-700">
                        Concluído
                    </span>
                </div>

                <div *ngIf="agendamento.status === 'cancelado' && !agendamento.isLoading">
                    <span
                        class="inline-flex items-center rounded-md bg-red-100 px-3 py-1 text-sm font-medium text-red-700">
                        Cancelado
                    </span>
                </div>
            </div>
        </div>
    </div>
</section>